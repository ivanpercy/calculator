
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="">
    <meta name="description" content="">
    <meta name="author" content="s">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>Calculadora</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous">

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .form1{
            width:18px;
            height:18px;
            background:rgba(255, 99, 132, 0.2);
            font-family:arial;
            font-weight:bold;
            color:#EEEEEE;
        }
        .form2{
            width:18px;
            height:18px;
            background:rgba(54, 162, 235, 0.2);
            font-family:arial;
            font-weight:bold;
            color:#EEEEEE;
        }
        .form3{
            width:18px;
            height:18px;
            background:rgba(255, 206, 86, 0.2);
            font-family:arial;
            font-weight:bold;
            color:#EEEEEE;
        }

    </style>
</head>
<body class="bg-light">
<div class="container" id="app">
    <div class="py-5 text-center">
        <img class="d-block mx-auto mb-4" src="https://getbootstrap.com/docs/4.3/assets/brand/bootstrap-solid.svg" alt="" width="72" height="72">
        <h2>Calculadora de Interés</h2>
        <p class="lead">
            Ingrese los datos para emular los intereses generados.
        </p>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="row" style="margin-bottom: 30px">
                <div class="col-md-4 mb-3">
                    <label>Monto Inicial</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">S/</span>
                        </div>
                        <input type="number" class="form-control" v-model="amount_initial">
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <label>Interés Anual</label>
                    <div class="input-group">
                        <input type="number" class="form-control" v-model="interest">
                        <div class="input-group-append">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <label>Años</label>
                    <input type="number" class="form-control" v-model="years">
                </div>
                <div class="col-md-4 mb-3">
                    <label>Monto de aporte</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">S/</span>
                        </div>
                        <input type="number" class="form-control" v-model="amount_regular">
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <label>Periodos de aporte</label>
                    <select class="custom-select d-block w-100" v-model="period">
                        <option v-for="option in periods" :value="option.value">
                            {{ option.text }}
                        </option>
                    </select>
                </div>
                <!--<div class="col-md-4 mb-3">
                    <label>Compuesto</label>
                    <select class="custom-select d-block w-100" v-model="compound">
                        <option v-for="option in compounds" :value="option.value">
                            {{ option.text }}
                        </option>
                    </select>
                </div>-->
            </div>
            <button class="btn btn-primary btn-lg btn-block" type="button" @click="firstStep()">
                Calcular intereses
            </button>
        </div>
    </div>
    <hr class="mb-4">
    <div class="row">
        <div class="col-md-4">
            <canvas id="myChart" width="400" height="400"></canvas>
        </div>
        <div class="col-md-8">
            <table>
                <tr>
                    <td style="width: 40px"><div class="form1"></div></td>
                    <td style="width: 200px">Monto aportado</td>
                    <td>S/ {{ parseInt(summary.total_amount).toFixed(2) }}</td>
                </tr>
                <tr>
                    <td><div class="form2"></div></td>
                    <td>Interés ganado</td>
                    <td>S/ {{ parseInt(summary.total_interest).toFixed(2) }}</td>
                </tr>
                <tr>
                    <td><div class="form3"></div></td>
                    <td>Total percibido</td>
                    <td>S/ {{ parseInt(summary.total_contribution).toFixed(2) }}</td>
                </tr>
            </table>
        </div>
    </div>
    <hr class="mb-4">
    <div class="row">
        <div class="col-md-12">
            <table class="table">
                <thead class="thead-dark">
                <tr>
                    <th scope="col">N°</th>
                    <th scope="col">Aporte</th>
                    <th scope="col">Interés</th>
                    <th scope="col">Total</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="(item, index) in data">
                    <td>{{ index + 1 }}</td>
                    <td>{{ parseInt(item.initial).toFixed(2) }}</td>
                    <td>{{ parseInt(item.interest).toFixed(2) }}</td>
                    <td>{{ parseInt(item.amount).toFixed(2) }}</td>
                </tr>
                </tbody>
                <tfoot>
                <tr>
                    <td></td>
                    <td>{{ parseInt(summary.total_amount).toFixed(2) }}</td>
                    <td>{{ parseInt(summary.total_interest).toFixed(2) }}</td>
                    <td>{{ parseInt(summary.total_contribution).toFixed(2) }}</td>
                </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>
<footer class="my-5 pt-5 text-muted text-center text-small">
    <p class="mb-1">© Todos los derechos reservados</p>
</footer>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>

<script>
    let app = new Vue({
        el: '#app',
        data: {
            amount_initial: 1000,
            amount_regular: 100,
            interest: 10,
            years: 2,
            period: 1,
            periods: [
                { text: 'Mensual', value: 12 },
                { text: 'Trimestral', value: 4 },
                { text: 'Cuatrimestral', value: 3 },
                { text: 'Bimestral', value: 2 },
                { text: 'Anual', value: 1 }
            ],
            compound: 360,
            compounds: [
                { text: 'Diario', value: 1 },
                { text: 'Mensual', value: 30 },
                { text: 'Anual', value: 360 }
            ],
            data: [],
            summary: {},
            chartDataLabel: [],
            chartDataAmount: [],
        },
        computed: {
            // Calcular total de aportes durante los años requeridos
            calculateTotalPeriods: function () {
                return this.period * parseInt(this.years);
            },
            // Primer aporte + monto inicial
            calculateFirstInvestment: function () {
                return  parseInt(this.amount_initial) + parseInt(this.amount_regular);
            },
        },
        methods: {
            firstStep: function () {
                let i;
                let amount = 0;
                let contributions = 0;
                let calculate_interest = 0;
                let initial_amount = this.calculateFirstInvestment;

                let information = [];
                let sum_contribution = 0;
                let sum_interest = 0;
                let sum_amount = 0;
                let sum_amount_regular = 0;
                let chart_labels = [];
                let chart_amounts = [];

                for (i = 0; i < this.calculateTotalPeriods; i++) {
                    amount = initial_amount * Math.pow((1 + (parseInt(this.interest) / 100)), 1);
                    contributions = contributions + parseInt(this.amount_regular);
                    calculate_interest = amount - contributions - parseInt(this.amount_initial);
                    initial_amount = amount;

                    information.push({
                        interest: calculate_interest,
                        amount: amount,
                        initial: initial_amount - calculate_interest
                    });

                    chart_labels.push(amount);
                    chart_amounts.push(calculate_interest);

                    sum_contribution = sum_amount + amount;
                    sum_interest = sum_interest + calculate_interest;
                    sum_amount = sum_amount + (initial_amount - calculate_interest);
                    sum_amount_regular = sum_amount_regular + parseInt(this.amount_regular);

                }

                this.data = information;
                this.summary = {
                    'total_contribution': sum_contribution,
                    'total_interest': sum_interest,
                    'total_amount':  sum_amount,
                    'total_amount_regular':  sum_amount_regular,
                };

                let ctx = document.getElementById('myChart').getContext('2d');
                let myChart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: ['Interés', 'Aporte regular', 'Inversión inicial'],
                        datasets: [{
                            label: '# of Votes',
                            data: [sum_interest, sum_amount_regular, parseInt(this.amount_initial)],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.2)',
                                'rgba(54, 162, 235, 0.2)',
                                'rgba(255, 206, 86, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

            }
        }
    })
</script>
</body>
</html>
